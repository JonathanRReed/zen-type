@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-Light.woff2') format('woff2');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-LightItalic.woff2') format('woff2');
  font-weight: 300;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-Book.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-Bold.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-BoldItalic.woff2') format('woff2');
  font-weight: 700;
  font-style: italic;
  font-display: swap;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --rp-base: #191724;
  --rp-surface: #1f1d2e;
  --rp-overlay: #26233a;
  --rp-muted: #6e6a86;
  --rp-subtle: #908caa;
  --rp-text: #e0def4;
  --rp-love: #eb6f92;
  --rp-gold: #f6c177;
  --rp-rose: #ea9a97;
  --rp-pine: #3e8fb0;
  --rp-foam: #9ccfd8;
  --rp-iris: #c4a7e7;
  --rp-hi-low: #21202e;
  --rp-hi-med: #403d52;
  --rp-hi-high: #524f67;
  --shadow-soft: 0 8px 30px rgba(0,0,0,var(--glow-strength));
  --blur: 12px;
  --glow-strength: 0.35;
  --ease-smooth: cubic-bezier(0.22, 1, 0.36, 1);
  /* Default ambient gradient (Rosé Pine on OLED-dark) */
  --theme-gradient: linear-gradient(180deg, var(--rp-base) 0%, var(--rp-overlay) 100%);
  --theme-gradient-angle: 180deg;
  --theme-gradient-center-x: 50%;
  --theme-gradient-center-y: 50%;
  --theme-hue-shift: 0deg;
  --typing-font: 'Nebula Sans', 'JetBrains Mono', 'Fira Code', 'IBM Plex Mono', 'Source Code Pro', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
  --ui-font: 'Nebula Sans', 'Inter', 'Manrope', 'Space Grotesk', 'Roboto', 'Segoe UI', 'Helvetica Neue', Arial, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

@property --blur {
  syntax: '<length>';
  inherits: true;
  initial-value: 12px;
}

@property --glow-strength {
  syntax: '<number>';
  inherits: true;
  initial-value: 0.35;
}

html {
  color-scheme: dark;
  view-transition-name: root;
}

body {
  background: var(--theme-gradient, var(--rp-base));
  color: var(--rp-text);
  font-family: var(--ui-font);
  margin: 0;
  padding: 0;
  min-height: 100vh;
  transition: opacity .2s var(--ease-smooth), transform .2s var(--ease-smooth);
  scrollbar-gutter: stable both-edges;
}

h1, h2, h3, h4 {
  text-wrap: balance;
}

.glass {
  background: color-mix(in oklab, var(--rp-surface) 80%, transparent);
  backdrop-filter: blur(var(--blur));
  box-shadow: var(--shadow-soft);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 12%, transparent);
}

.typing-font { font-family: var(--typing-font); }

.settings-shell {
  background: color-mix(in oklab, var(--rp-overlay) 72%, transparent);
  border-radius: 24px;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  box-shadow:
    0 10px 40px rgba(0, 0, 0, 0.45),
    inset 0 1px 0 color-mix(in oklab, var(--rp-foam) 12%, transparent);
}

.settings-shell h2 {
  font-size: 1.75rem;
  color: color-mix(in oklab, var(--rp-foam) 75%, var(--rp-text) 25%);
}

.settings-shell select,
.settings-shell input[type="number"],
.settings-shell input[type="range"] {
  border-radius: 14px;
}

.settings-shell input[type="checkbox"] {
  width: 20px;
  height: 20px;
  border-radius: 6px;
}

.settings-shell label,
.settings-shell .grid {
  background: color-mix(in oklab, var(--rp-surface) 60%, transparent);
  border-radius: 16px;
  padding: 0.75rem 1rem;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 12%, transparent);
}

.settings-shell label + label,
.settings-shell .grid + label,
.settings-shell .grid + .grid {
  margin-top: 0.75rem;
}

.settings-shell input[type="range"] {
  accent-color: color-mix(in oklab, var(--rp-foam) 65%, var(--rp-iris) 35%);
}

.settings-shell .settings-footer {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid color-mix(in oklab, var(--rp-iris) 14%, transparent);
}

.settings-scroll::-webkit-scrollbar {
  width: 10px;
}

.settings-scroll::-webkit-scrollbar-thumb {
  background: rgba(156, 207, 216, 0.25);
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: content-box;
}

.settings-scroll::-webkit-scrollbar-track {
  background: transparent;
}

/* High contrast mode */
html.high-contrast .glass {
  background: color-mix(in oklab, var(--rp-surface) 92%, transparent);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 35%, transparent);
}
html.high-contrast :focus-visible {
  outline: 3px solid var(--rp-iris);
  outline-offset: 2px;
}
html.high-contrast .pause-btn {
  background: color-mix(in oklab, var(--rp-overlay) 85%, transparent);
  border-color: color-mix(in oklab, var(--rp-foam) 45%, transparent);
  color: var(--rp-text);
}

.caret {
  width: 2px;
  animation: blink 0.7s step-end infinite;
}

/* Accent caret for inputs */
.caret-accent { caret-color: var(--rp-iris); }

/* Vignette overlay to add depth on scenes */
.vignette {
  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.32) 100%);
}

/* Ghost buttons (header micro-controls) */
.button-ghost {
  background: color-mix(in oklab, var(--rp-overlay) 55%, transparent);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  color: var(--rp-subtle);
  transition: background .2s var(--ease-smooth), color .2s var(--ease-smooth), border-color .2s var(--ease-smooth);
}
.button-ghost:hover {
  background: color-mix(in oklab, var(--rp-overlay) 75%, transparent);
  color: var(--rp-text);
  border-color: color-mix(in oklab, var(--rp-iris) 32%, transparent);
}

.pause-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 0.85rem;
  border-radius: 0.95rem;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  background: color-mix(in oklab, var(--rp-overlay) 65%, transparent);
  box-shadow:
    0 6px 22px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(255,255,255,0.04);
  color: color-mix(in oklab, var(--rp-text) 88%, var(--rp-foam) 12%);
  font-size: 0.875rem;
  font-weight: 500;
  transition: transform 160ms var(--ease-smooth), box-shadow 160ms var(--ease-smooth), background 160ms var(--ease-smooth), border-color 160ms var(--ease-smooth);
}

.pause-btn:hover,
.pause-btn:focus-visible {
  transform: translateY(-1px);
  background: color-mix(in oklab, var(--rp-overlay) 75%, transparent);
  border-color: color-mix(in oklab, var(--rp-iris) 28%, transparent);
  box-shadow:
    0 10px 28px rgba(0,0,0,0.45),
    inset 0 1px 0 rgba(255,255,255,0.08);
  color: var(--rp-text);
}

.pause-btn:active {
  transform: translateY(0);
  background: color-mix(in oklab, var(--rp-overlay) 62%, transparent);
}

.pause-btn-icon svg {
  display: block;
  stroke: currentColor;
  stroke-width: 1.2;
  fill: none;
}

.pause-btn-label {
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 0.72rem;
}

.font-select {
  appearance: none;
  padding: 0.45rem 2.5rem 0.45rem 0.85rem;
  border-radius: 0.9rem;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  background:
    linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0))
    color-mix(in oklab, var(--rp-overlay) 65%, transparent);
  color: color-mix(in oklab, var(--rp-text) 90%, var(--rp-foam) 10%);
  font-family: var(--typing-font);
  font-size: 0.85rem;
  letter-spacing: 0.04em;
  transition: border-color 160ms var(--ease-smooth), box-shadow 160ms var(--ease-smooth), background 160ms var(--ease-smooth), color 160ms var(--ease-smooth);
  background-image:
    linear-gradient(45deg, transparent 50%, color-mix(in oklab, var(--rp-foam) 65%, transparent) 50%),
    linear-gradient(135deg, color-mix(in oklab, var(--rp-foam) 65%, transparent) 50%, transparent 50%),
    linear-gradient(to right, rgba(255,255,255,0.15), rgba(255,255,255,0));
  background-position:
    calc(100% - 1.4rem) center,
    calc(100% - 0.9rem) center,
    center;
  background-size:
    8px 8px,
    8px 8px,
    auto;
  background-repeat: no-repeat;
}

.font-select:hover,
.font-select:focus-visible {
  border-color: color-mix(in oklab, var(--rp-iris) 28%, transparent);
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--rp-iris) 12%, transparent);
  color: var(--rp-text);
}

/* Focus-visible accessibility ring across interactive elements */
:where(a, button, [role="button"], input, select, textarea, [tabindex]):focus-visible {
  outline: 2px solid color-mix(in oklab, var(--rp-iris) 70%, transparent);
  outline-offset: 2px;
  box-shadow: 0 0 0 6px color-mix(in oklab, var(--rp-iris) 18%, transparent);
}

/* Cards: subtle hover animation and glow */
.card {
  @apply rounded-2xl;
  background: color-mix(in oklab, var(--rp-surface) 80%, transparent);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 14%, transparent);
  backdrop-filter: blur(var(--blur));
  box-shadow: var(--shadow-soft);
  transition: transform .2s var(--ease-smooth), background .2s var(--ease-smooth), border-color .2s var(--ease-smooth), box-shadow .2s var(--ease-smooth);
}
.card:hover, .card:focus-visible {
  transform: translateY(-2px) scale(1.01);
  border-color: color-mix(in oklab, var(--rp-iris) 26%, transparent);
  box-shadow: 0 10px 36px rgba(0,0,0,.4);
}

.stats-bar .glass,
[data-archive-shell] h2,
[data-archive-shell] h3 {
  text-wrap: balance;
  font-family: var(--typing-font);
}

[data-archive-shell] p {
  text-wrap: pretty;
}

/* Context-aware highlights using :has() (scoped for supporting browsers) */
@supports selector(:has(*)) {
  .glass:has(input:focus-visible),
  .glass:has(textarea:focus-visible),
  .card:has(:focus-visible) {
    border-color: color-mix(in oklab, var(--rp-iris) 28%, transparent);
    box-shadow: 0 0 0 6px color-mix(in oklab, var(--rp-iris) 12%, transparent), var(--shadow-soft);
  }
}

/* Scroll snap utilities (used by Archive overlay lists) */
.snap-y { scroll-snap-type: y proximity; }
.snap-x { scroll-snap-type: x proximity; }
.snap-mandatory { scroll-snap-type: y mandatory; }
.snap-item { scroll-snap-align: start; }

/* Container queries for responsive HUD layout */
.stats-cq-host { container: zen-shell / inline-size; }
.stats-cq { container-type: inline-size; }

@container zen-shell (max-width: 900px) {
  header.fixed {
    flex-wrap: wrap;
    gap: 1.25rem;
  }

  header.fixed > div:last-child {
    width: 100%;
    justify-content: space-between;
    gap: 1rem;
  }
}

@container (max-width: 720px) {
  .stats-bar {
    position: static;
    transform: none;
    margin: 1rem auto 0;
    left: auto;
    right: auto;
    bottom: auto;
  }

  .stats-bar .glass {
    justify-content: space-between;
    width: min(100% - 1.5rem, 28rem);
  }
}

@container (max-width: 560px) {
  .stats-bar {
    margin-bottom: 0.5rem;
  }
  .stats-bar .glass {
    padding: .5rem .75rem;
    gap: 1.25rem;
  }
}

@container (min-width: 1000px) {
  .stats-bar .glass { gap: 2rem; }
}

/* Page transitions */
html.page-enter body {
  opacity: 0;
  transform: translateY(12px);
}

html.page-enter body,
html.page-exit body {
  transition: opacity 260ms var(--ease-smooth), transform 260ms var(--ease-smooth);
}

html.page-enter.body-ready body {
  opacity: 1;
  transform: translateY(0);
}

html.page-exit body {
  opacity: 0;
  transform: translateY(-12px);
}

/* Lightweight grain overlay */
.grain {
  background-image:
    radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
    radial-gradient(rgba(0,0,0,0.04) 1px, transparent 1px);
  background-size: 2px 2px, 3px 3px;
  background-position: 0 0, 1px 1px;
  opacity: .25;
  mix-blend-mode: soft-light;
}

/* Theme base layer */
.theme-layer {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--theme-gradient, linear-gradient(180deg, var(--rp-base), var(--rp-overlay)));
  filter: none;
}

/* Keyframes */
@keyframes forestBreath90 {
  0%,100% {
    background-position: 50% 52%, 16% -6%, 82% -10%, 50% 100%;
    filter: saturate(0.96);
  }
  50% {
    background-position: 52% 49%, 18% -4%, 80% -8%, 50% 102%;
    filter: saturate(1.04);
  }
}
@keyframes leafGlide90 {
  0% {
    background-position: 15% -15%, 42% -20%, 65% -12%, 85% -18%;
    opacity: 0;
  }
  10% {
    opacity: .05;
  }
  50% {
    background-position: 18% 45%, 45% 40%, 62% 48%, 82% 42%;
    opacity: .04;
  }
  90% {
    opacity: .02;
  }
  100% {
    background-position: 20% 110%, 48% 108%, 58% 112%, 78% 110%;
    opacity: 0;
  }
}
@keyframes oceanDrift90 {
  0%,100% {
    background-position: 50% 52%, 50% 50%, 50% 48%;
  }
  50% {
    background-position: 48% 50%, 52% 49%, 50% 51%;
  }
}
@keyframes oceanBubble30 {
  0% {
    background-position: 20% 110%, 60% 115%, 85% 112%;
    opacity: 0;
  }
  5% {
    opacity: .84;
  }
  50% {
    background-position: 22% 55%, 62% 58%, 83% 52%;
    opacity: .66;
  }
  95% {
    opacity: .38;
  }
  100% {
    background-position: 24% -5%, 64% -8%, 81% -10%;
    opacity: 0;
  }
}
@keyframes oceanBubbleSlow60 {
  0% {
    background-position: 12% 120%, 42% 118%, 78% 122%;
    opacity: 0;
  }
  10% {
    opacity: .36;
  }
  55% {
    background-position: 14% 62%, 44% 60%, 76% 64%;
    opacity: .42;
  }
  95% {
    opacity: .12;
  }
  100% {
    background-position: 16% -6%, 46% -4%, 74% -2%;
    opacity: 0;
  }
}
@keyframes oceanLightSweep30 {
  0% {
    transform: translateY(0%) scaleY(1);
    opacity: .18;
  }
  50% {
    transform: translateY(-2.5%) scaleY(1.05);
    opacity: .28;
  }
  100% {
    transform: translateY(0.5%) scaleY(1);
    opacity: .16;
  }
}
@keyframes oceanParticleDrift80 {
  0% {
    background-position:
      center top,
      18% 118%,
      74% 120%,
      46% 122%;
    transform: translate3d(0, 0, 0);
    opacity: .26;
  }
  50% {
    background-position:
      center top,
      22% 76%,
      70% 82%,
      44% 86%;
    transform: translate3d(1.2%, -2%, 0);
    opacity: .32;
  }
  100% {
    background-position:
      center top,
      26% 38%,
      66% 46%,
      42% 52%;
    transform: translate3d(-1.4%, -4%, 0);
    opacity: .22;
  }
}
@keyframes horizonShimmer15 {
  0%,100% {
    opacity: .35;
    transform: translateY(0);
  }
  50% {
    opacity: .45;
    transform: translateY(-0.5%);
  }
}
@keyframes cosmicHue120 {
  0%,100% {
    filter: hue-rotate(0deg) saturate(1);
  }
  50% {
    filter: hue-rotate(2deg) saturate(1.03);
  }
}
@keyframes cosmicTwinkle25 {
  0%,100% {
    opacity: .45;
  }
  25% {
    opacity: .65;
  }
  50% {
    opacity: .35;
  }
  75% {
    opacity: .55;
  }
}
@keyframes cosmicComet120 {
  0% {
    opacity: 0;
    transform: translate3d(-20%, -12%, 0) rotate(22deg);
  }
  2% {
    opacity: .15;
  }
  5% {
    opacity: .08;
    transform: translate3d(120%, 15%, 0) rotate(22deg);
  }
  100% {
    opacity: 0;
    transform: translate3d(120%, 15%, 0) rotate(22deg);
  }
}
@keyframes voidScroll180 {
  0% {
    background-position: 50% 0%;
  }
  100% {
    background-position: 50% 5%;
  }
}

/* Forest: True greens with Rosé Pine harmony and organic overlays */
html.theme-forest {
  --forest-0: #0e1914;
  --forest-1: #13231a;
  --forest-2: #1b3628;
  --forest-3: #284936;
  --moss: #7fbf9e;
  --leaf: #a3d9b1;
  --pine-mix: color-mix(in oklab, var(--rp-pine) 25%, #1b3628 75%);
}
html.theme-forest .theme-layer {
  --bg-a: var(--forest-1);
  --bg-b: var(--forest-3);
  background:
    radial-gradient(120% 80% at 50% -10%, color-mix(in oklab, var(--bg-b) 65%, #000 35%), var(--bg-a)),
    linear-gradient(180deg, var(--bg-a), var(--bg-b));
}
/* Organic grain overlay */
html.theme-forest .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" opacity=".06"><filter id="n"><feTurbulence baseFrequency=".9" numOctaves="1"/></filter><rect width="100%" height="100%" filter="url(%23n)"/></svg>');
  mix-blend-mode: soft-light;
}
/* Gentle breathing gradient */
html.theme-forest[data-motion="on"] .theme-layer::after {
  content:""; position:absolute; inset:-10%; pointer-events:none;
  background: radial-gradient(120% 80% at 50% 60%, transparent, color-mix(in oklab,var(--moss) 8%, transparent));
  animation: forest-breathe 90s ease-in-out infinite;
}
@keyframes forest-breathe { 50% { filter: brightness(1.05); } }
/* Remove dotted wallpaper for Forest */
html.theme-forest .grain { background: none !important; opacity: 0 !important; }

/* Ocean: Deep blues with seafoam accents and wave shimmer */
html.theme-ocean {
  --ocean-0: #07131e;
  --ocean-1: #0a2436;
  --ocean-2: #0f3a57;
  --ocean-3: #145275;
  --seafoam: #9ccfd8;
  --deep: #082031;
  --plankton-foam: color-mix(in oklab, var(--seafoam) 82%, transparent);
  --plankton-iris: color-mix(in oklab, var(--rp-iris) 58%, transparent);
  --cascade-wash: color-mix(in oklab, var(--seafoam) 18%, transparent);
}
html.theme-ocean .theme-layer {
  background:
    radial-gradient(120% 90% at 50% -20%, var(--ocean-2), var(--ocean-0)),
    linear-gradient(180deg, var(--ocean-1), var(--ocean-3));
}
/* Wave shimmer (motion only) */
html.theme-ocean[data-motion="on"] .theme-layer::before {
  content:""; position:absolute; inset:-6% -8% 0; pointer-events:none;
  background-image:
    conic-gradient(from 200deg at 50% 55%,
      color-mix(in oklab,var(--seafoam) 7%, transparent) 0%,
      transparent 32%,
      color-mix(in oklab,var(--seafoam) 5%, transparent) 55%,
      transparent 75%),
    radial-gradient(ellipse 110% 140% at 50% 0%,
      color-mix(in oklab,var(--seafoam) 14%, transparent) 0%,
      transparent 70%);
  background-size: 100% 100%, 120% 140%;
  background-position: 50% 58%, 50% 104%;
  background-repeat: no-repeat;
  mix-blend-mode: screen;
  opacity: .16;
  transform-origin: 50% 42%;
  animation: ocean-wave 12s ease-in-out infinite, oceanLightSweep30 30s ease-in-out infinite;
}
@keyframes ocean-wave { 
  50% { transform: translateY(-2%) scaleY(1.02); filter: blur(1.5px); }
}
/* Horizon shimmer: soften and remove visible band line */
html.theme-ocean .theme-layer::after {
  content:""; position:absolute; inset:-6% -10% -8% -10%; pointer-events:none;
  background-image:
    linear-gradient(180deg,
      rgba(255,255,255,0.015) 0%,
      rgba(255,255,255,0.009) 16%,
      rgba(255,255,255,0.003) 34%,
      rgba(255,255,255,0.0) 52%),
    radial-gradient(42% 32% at 22% 122%, color-mix(in oklab,var(--plankton-foam) 55%, transparent) 0%, transparent 80%),
    radial-gradient(38% 28% at 72% 124%, color-mix(in oklab,var(--plankton-iris) 52%, transparent) 0%, transparent 82%),
    radial-gradient(36% 26% at 48% 132%, color-mix(in oklab,var(--cascade-wash) 45%, transparent) 0%, transparent 84%);
  background-size: 100% 100%, 18vw 18vw, 15vw 15vw, 16vw 16vw;
  background-position:
    center top,
    22% 122%,
    72% 124%,
    46% 132%;
  background-repeat: no-repeat;
  mix-blend-mode: screen;
  opacity: .17;
}

html.theme-ocean[data-motion="on"] .theme-layer::after {
  animation:
    oceanParticleDrift80 80s ease-in-out infinite,
    oceanBubbleSlow60 60s ease-in-out infinite;
}

html.theme-ocean[data-motion="off"] .theme-layer::before {
  animation: none;
  background-position: 50% 58%, 50% 106%;
}

html.theme-ocean[data-motion="off"] .theme-layer::after {
  animation: none;
  background-position:
    center top,
    24% 86%,
    70% 90%,
    50% 94%;
  opacity: .16;
}
/* Remove dotted wallpaper for Ocean */
html.theme-ocean .grain { background: none !important; opacity: 0 !important; }

/* Cosmic: Dark violet/black base with Rosé Pine accents */
html.theme-cosmic .theme-layer {
  background-image:
    radial-gradient(ellipse 110% 70% at 50% 25%, color-mix(in oklab, var(--rp-iris) 20%, #0a0014 80%) 0%, transparent 65%),
    radial-gradient(ellipse 90% 45% at 50% 85%, color-mix(in oklab, #120825 85%, var(--rp-iris) 15%) 0%, transparent 55%),
    var(--theme-gradient, radial-gradient(ellipse at 50% 50%, #0a0014, #120825, #050008));
  background-size: 140% 140%, 100% 100%, 100% 100%;
  background-position: 50% 50%, 50% 100%, 50% 50%;
  filter: saturate(0.98) hue-rotate(var(--theme-hue-shift, 0deg));
  animation: cosmicHue120 120s ease-in-out infinite;
}
html.theme-cosmic .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  /* Starfield: fewer, brighter dots that twinkle slowly */
  background-image:
    radial-gradient(2px 2px at 22% 28%, rgba(255,255,255,0.9) 45%, transparent 55%),
    radial-gradient(1.8px 1.8px at 45% 65%, rgba(255,255,255,0.95) 45%, transparent 55%),
    radial-gradient(2.2px 2.2px at 68% 42%, rgba(255,255,255,0.85) 45%, transparent 55%),
    radial-gradient(1.9px 1.9px at 82% 55%, rgba(255,255,255,0.88) 45%, transparent 55%),
    radial-gradient(2.1px 2.1px at 35% 85%, rgba(255,255,255,0.92) 45%, transparent 55%),
    radial-gradient(1.7px 1.7px at 12% 45%, rgba(255,255,255,0.86) 45%, transparent 55%);
  background-size: auto;
  background-repeat: no-repeat;
  animation: cosmicTwinkle25 25s ease-in-out infinite;
  opacity: .45;
}
html.theme-cosmic .theme-layer::after {
  content:""; position:absolute; inset:auto; pointer-events:none;
  /* Rare faint comet streak (every ~120s) */
  top: 18%; left: -15%; width: 35%; height: 1.5px;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(196,167,231,0.25), rgba(255,255,255,0));
  transform: rotate(22deg);
  animation: cosmicComet120 120s linear infinite;
  animation-delay: 15s;
  opacity: 0;
}
html.theme-cosmic .grain {
  background-image:
    radial-gradient(rgba(255,255,255,0.025) 1px, transparent 1px),
    radial-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
    linear-gradient(180deg, rgba(18,8,37,0.3) 0%, rgba(5,0,10,0) 100%);
  background-size: 3px 3px, 4px 4px, 100% 100%;
  background-position: 0 0, 1px 1px, 0 0;
  opacity: .18;
  mix-blend-mode: soft-light;
}

/* Void: Deep Rosé Pine void with soft aurora pulses */
html.theme-void {
  --void-ink: color-mix(in oklab, var(--rp-base) 80%, #050209 20%);
  --void-veil: color-mix(in oklab, var(--rp-overlay) 85%, #000000 15%);
  --void-iris: color-mix(in oklab, var(--rp-iris) 18%, transparent);
  --void-foam: color-mix(in oklab, var(--rp-foam) 12%, transparent);
}
html.theme-void .theme-layer {
  background:
    radial-gradient(110% 80% at 50% 20%, rgba(12, 6, 24, 0.58), transparent 70%),
    linear-gradient(200deg, var(--void-ink) 0%, var(--void-veil) 60%, color-mix(in oklab, var(--rp-base) 96%, #000 4%) 100%);
  background-size: 100% 115%;
  background-position: 50% 0%;
  animation: voidScroll180 180s linear infinite;
  filter: saturate(0.94) brightness(0.98);
}
html.theme-void .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  background: radial-gradient(ellipse 60% 24% at 50% 58%, var(--void-iris), transparent 70%);
  opacity: .35;
  mix-blend-mode: screen;
  animation: voidPulse 26s ease-in-out infinite;
}
html.theme-void .theme-layer::after {
  content:""; position:absolute; inset:0; pointer-events:none;
  background:
    radial-gradient(ellipse 40% 18% at 50% 65%, color-mix(in oklab, var(--rp-iris) 10%, transparent) 0%, transparent 70%),
    radial-gradient(ellipse 55% 35% at 50% 100%, color-mix(in oklab, var(--rp-gold) 6%, transparent) 0%, transparent 100%);
  mix-blend-mode: screen;
  opacity: .65;
}
html.theme-void .grain {
  opacity: .18;
  mix-blend-mode: soft-light;
}
@keyframes voidPulse {
  0%, 100% {
    transform: translateY(0) scaleX(1);
    opacity: .32;
  }
  50% {
    transform: translateY(-1.2%) scaleX(1.02);
    opacity: .45;
  }
}
html.theme-void[data-motion="on"] .theme-layer::before {
  animation-play-state: running;
}
html.theme-void[data-motion="off"] .theme-layer::before {
  animation: none;
  opacity: .32;
}
html.high-contrast .grain {
  opacity: .3;
}
html.high-contrast.theme-forest .theme-layer::after {
  opacity: .66;
}
html.high-contrast.theme-ocean .theme-layer::after {
  opacity: .2;
}
html.high-contrast.theme-cosmic .theme-layer::before {
  opacity: .75;
}
html.high-contrast.theme-cosmic .theme-layer::after {
  opacity: .2;
}
html.high-contrast.theme-void .theme-layer::after {
  opacity: .78;
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}

@keyframes vt-fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

@keyframes vt-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

:root::view-transition-old(root),
:root::view-transition-new(root) {
  animation-duration: 260ms;
  animation-timing-function: var(--ease-smooth);
}

:root::view-transition-old(root) {
  animation-name: vt-fade-out;
}

:root::view-transition-new(root) {
  animation-name: vt-fade-in;
}

:root[data-transition-theme="theme-void"]::view-transition-new(root) {
  animation-name: vt-fade-in;
  animation-duration: 320ms;
}

:root[data-transition-theme="theme-forest"]::view-transition-new(root),
:root[data-transition-theme="theme-ocean"]::view-transition-new(root),
:root[data-transition-theme="theme-cosmic"]::view-transition-new(root) {
  animation-duration: 320ms;
}

@media (prefers-reduced-motion: reduce) {
  body {
    transition: none !important;
  }

  html.theme-forest .theme-layer,
  html.theme-forest .theme-layer::before,
  html.theme-forest .theme-layer::after,
  html.theme-ocean .theme-layer,
  html.theme-ocean .theme-layer::before,
  html.theme-ocean .theme-layer::after,
  html.theme-cosmic .theme-layer,
  html.theme-cosmic .theme-layer::before,
  html.theme-cosmic .theme-layer::after,
  html.theme-void .theme-layer,
  html.theme-void .theme-layer::after,
  .grain {
    animation: none !important;
    transform: none !important;
  }

  html.theme-forest .theme-layer,
  html.theme-cosmic .theme-layer,
  html.theme-void .theme-layer {
    filter: none !important;
  }

  html.theme-ocean .theme-layer::after {
    opacity: .08 !important;
  }
}

@media (prefers-contrast: more) {
  :root {
    --shadow-soft: 0 0 0 1px rgba(255,255,255,0.35);
  }

  .glass,
  .card {
    border-color: color-mix(in oklab, var(--rp-iris) 35%, transparent);
    background: color-mix(in oklab, var(--rp-surface) 92%, transparent);
  }

  :where(button, a, input, textarea, select) {
    border-color: color-mix(in oklab, var(--rp-foam) 40%, transparent) !important;
  }
}

@supports (scrollbar-color: auto) {
  body {
    scrollbar-color: rgba(144,140,170,0.65) transparent;
  }
}

body::-webkit-scrollbar,
.stats-bar::-webkit-scrollbar {
  height: 10px;
  width: 10px;
}

body::-webkit-scrollbar-thumb,
.stats-bar::-webkit-scrollbar-thumb {
  background: rgba(144,140,170,0.4);
  border-radius: 999px;
}
