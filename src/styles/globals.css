@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-Light.woff2') format('woff2');
  font-weight: 300;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-LightItalic.woff2') format('woff2');
  font-weight: 300;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-Book.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-Bold.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'Nebula Sans';
  src: url('https://fonts.helloworldfirm.com/NebulaSans-BoldItalic.woff2') format('woff2');
  font-weight: 700;
  font-style: italic;
  font-display: swap;
}

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --rp-base: #191724;
  --rp-surface: #1f1d2e;
  --rp-overlay: #26233a;
  --rp-muted: #6e6a86;
  --rp-subtle: #908caa;
  --rp-text: #e0def4;
  --rp-love: #eb6f92;
  --rp-gold: #f6c177;
  --rp-rose: #ea9a97;
  --rp-pine: #3e8fb0;
  --rp-foam: #9ccfd8;
  --rp-iris: #c4a7e7;
  --rp-hi-low: #21202e;
  --rp-hi-med: #403d52;
  --rp-hi-high: #524f67;
  --shadow-soft: 0 8px 30px rgba(0,0,0,var(--glow-strength));
  --blur: 12px;
  --glow-strength: 0.35;
  --ease-smooth: cubic-bezier(0.22, 1, 0.36, 1);
  /* Default ambient gradient (Rosé Pine on OLED-dark) */
  --theme-gradient: linear-gradient(180deg, var(--rp-base) 0%, var(--rp-overlay) 100%);
  --theme-gradient-angle: 180deg;
  --theme-gradient-center-x: 50%;
  --theme-gradient-center-y: 50%;
  --theme-hue-shift: 0deg;
  --typing-font: 'Nebula Sans', 'JetBrains Mono', 'Fira Code', 'IBM Plex Mono', 'Source Code Pro', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
  --ui-font: 'Nebula Sans', 'Inter', 'Manrope', 'Space Grotesk', 'Roboto', 'Segoe UI', 'Helvetica Neue', Arial, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  
  --radius: 0.75rem;
  --background: 270 20% 10%;
  --foreground: 267 57% 92%;
  --card: 270 20% 12%;
  --card-foreground: 267 57% 92%;
  --popover: 270 20% 12%;
  --popover-foreground: 267 57% 92%;
  --primary: 267 57% 78%;
  --primary-foreground: 270 20% 10%;
  --secondary: 249 12% 47%;
  --secondary-foreground: 267 57% 92%;
  --muted: 249 12% 47%;
  --muted-foreground: 249 12% 66%;
  --accent: 2 66% 83%;
  --accent-foreground: 270 20% 10%;
  --destructive: 343 76% 68%;
  --destructive-foreground: 267 57% 92%;
  --border: 267 57% 50% / 0.2;
  --input: 267 57% 50% / 0.2;
  --ring: 267 57% 78%;
}

@property --blur {
  syntax: '<length>';
  inherits: true;
  initial-value: 12px;
}

@property --glow-strength {
  syntax: '<number>';
  inherits: true;
  initial-value: 0.35;
}

html {
  color-scheme: dark;
  view-transition-name: root;
}

body {
  background: var(--theme-gradient, var(--rp-base));
  color: var(--rp-text);
  font-family: var(--ui-font);
  margin: 0;
  padding: 0;
  min-height: 100vh;
  transition: opacity .2s var(--ease-smooth), transform .2s var(--ease-smooth);
  scrollbar-gutter: stable both-edges;
}

h1, h2, h3, h4 {
  text-wrap: balance;
}

.glass {
  background: color-mix(in oklab, var(--rp-surface) 80%, transparent);
  backdrop-filter: blur(var(--blur));
  box-shadow: var(--shadow-soft);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 12%, transparent);
}

.typing-font { font-family: var(--typing-font); }

.settings-shell {
  background: color-mix(in oklab, var(--rp-overlay) 72%, transparent);
  border-radius: 24px;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  box-shadow:
    0 10px 40px rgba(0, 0, 0, 0.45),
    inset 0 1px 0 color-mix(in oklab, var(--rp-foam) 12%, transparent);
}

.settings-shell h2 {
  font-size: 1.75rem;
  color: color-mix(in oklab, var(--rp-foam) 75%, var(--rp-text) 25%);
}

.settings-shell select,
.settings-shell input[type="number"],
.settings-shell input[type="range"] {
  border-radius: 14px;
}

.settings-shell input[type="checkbox"] {
  width: 20px;
  height: 20px;
  border-radius: 6px;
}

.settings-shell label,
.settings-shell .grid {
  background: color-mix(in oklab, var(--rp-surface) 60%, transparent);
  border-radius: 16px;
  padding: 0.75rem 1rem;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 12%, transparent);
}

.settings-shell label + label,
.settings-shell .grid + label,
.settings-shell .grid + .grid {
  margin-top: 0.75rem;
}

.settings-shell input[type="range"] {
  accent-color: color-mix(in oklab, var(--rp-foam) 65%, var(--rp-iris) 35%);
}

.settings-shell .settings-footer {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid color-mix(in oklab, var(--rp-iris) 14%, transparent);
}

.settings-scroll::-webkit-scrollbar {
  width: 10px;
}

.settings-scroll::-webkit-scrollbar-thumb {
  background: rgba(156, 207, 216, 0.25);
  border-radius: 999px;
  border: 2px solid transparent;
  background-clip: content-box;
}

.settings-scroll::-webkit-scrollbar-track {
  background: transparent;
}

/* High contrast mode */
html.high-contrast .glass {
  background: color-mix(in oklab, var(--rp-surface) 92%, transparent);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 35%, transparent);
}
html.high-contrast :focus-visible {
  outline: 3px solid var(--rp-iris);
  outline-offset: 2px;
}
html.high-contrast .pause-btn {
  background: color-mix(in oklab, var(--rp-overlay) 85%, transparent);
  border-color: color-mix(in oklab, var(--rp-foam) 45%, transparent);
  color: var(--rp-text);
}

.caret {
  width: 2px;
  animation: blink 0.7s step-end infinite;
}

/* Accent caret for inputs */
.caret-accent { caret-color: var(--rp-iris); }

/* Zen typing input states */
.zen-input {
  position: relative;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 
    0 4px 12px rgba(0, 0, 0, 0.3),
    inset 0 0 0 1px rgba(196, 167, 231, 0.2);
  background-color: rgba(33, 32, 46, 0.8);
}

.zen-input:focus {
  animation: zen-input-focus 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.zen-input[data-typing="true"] {
  animation: zen-ripple 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

html:not([data-motion="off"]) .zen-input:focus:not([data-typing="true"]) {
  animation: zen-input-breathe 4s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.zen-input::placeholder {
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.zen-input:focus::placeholder {
  opacity: 0.4;
  transform: translateY(-1px);
}

/* Zen caret animation */
.zen-caret {
  animation: zen-caret-pulse 1.2s ease-in-out infinite;
  transform-origin: center;
}

/* Quote typing character animations */
.quote-char {
  display: inline-block;
  animation: zen-char-appear 0.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.quote-char.correct {
  color: var(--rp-foam);
}

.quote-char.error {
  color: var(--rp-love);
  animation: zen-char-appear 0.15s cubic-bezier(0.4, 0, 0.2, 1) forwards,
             zen-glow-pulse 0.3s ease-in-out;
}

.quote-char.pending {
  opacity: 0.35;
  transition: opacity 0.2s ease;
}

/* Reduce motion preferences */
html[data-motion="off"] .zen-input {
  animation: none !important;
}

html[data-motion="off"] .zen-input:focus {
  box-shadow: 0 0 0 2px rgba(196, 167, 231, 0.3);
  animation: none !important;
}

html[data-motion="off"] .quote-char {
  animation: none !important;
}

html[data-motion="off"] .zen-caret {
  animation: blink 0.7s step-end infinite;
}

/* Vignette overlay to add depth on scenes */
.vignette {
  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 60%, rgba(0,0,0,0.32) 100%);
}

/* Ghost buttons (header micro-controls) */
.button-ghost {
  background: color-mix(in oklab, var(--rp-overlay) 55%, transparent);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  color: var(--rp-subtle);
  transition: background .2s var(--ease-smooth), color .2s var(--ease-smooth), border-color .2s var(--ease-smooth);
}
.button-ghost:hover {
  background: color-mix(in oklab, var(--rp-overlay) 75%, transparent);
  color: var(--rp-text);
  border-color: color-mix(in oklab, var(--rp-iris) 32%, transparent);
}

.pause-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 0.85rem;
  border-radius: 0.95rem;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  background: color-mix(in oklab, var(--rp-overlay) 65%, transparent);
  box-shadow:
    0 6px 22px rgba(0,0,0,0.4),
    inset 0 1px 0 rgba(255,255,255,0.04);
  color: color-mix(in oklab, var(--rp-text) 88%, var(--rp-foam) 12%);
  font-size: 0.875rem;
  font-weight: 500;
  transition: transform 160ms var(--ease-smooth), box-shadow 160ms var(--ease-smooth), background 160ms var(--ease-smooth), border-color 160ms var(--ease-smooth);
}

.pause-btn:hover,
.pause-btn:focus-visible {
  transform: translateY(-1px);
  background: color-mix(in oklab, var(--rp-overlay) 75%, transparent);
  border-color: color-mix(in oklab, var(--rp-iris) 28%, transparent);
  box-shadow:
    0 10px 28px rgba(0,0,0,0.45),
    inset 0 1px 0 rgba(255,255,255,0.08);
  color: var(--rp-text);
}

.pause-btn:active {
  transform: translateY(0);
  background: color-mix(in oklab, var(--rp-overlay) 62%, transparent);
}

.pause-btn-icon svg {
  display: block;
  stroke: currentColor;
  stroke-width: 1.5;
  fill: none;
}

.pause-btn-icon svg * {
  stroke-linecap: round;
  stroke-linejoin: round;
}

.pause-btn-label {
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-size: 0.72rem;
}

.font-select {
  appearance: none;
  padding: 0.45rem 2.5rem 0.45rem 0.85rem;
  border-radius: 0.9rem;
  border: 1px solid color-mix(in oklab, var(--rp-iris) 18%, transparent);
  background:
    linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0))
    color-mix(in oklab, var(--rp-overlay) 65%, transparent);
  color: color-mix(in oklab, var(--rp-text) 90%, var(--rp-foam) 10%);
  font-family: var(--typing-font);
  font-size: 0.85rem;
  letter-spacing: 0.04em;
  transition: border-color 160ms var(--ease-smooth), box-shadow 160ms var(--ease-smooth), background 160ms var(--ease-smooth), color 160ms var(--ease-smooth);
  background-image:
    linear-gradient(45deg, transparent 50%, color-mix(in oklab, var(--rp-foam) 65%, transparent) 50%),
    linear-gradient(135deg, color-mix(in oklab, var(--rp-foam) 65%, transparent) 50%, transparent 50%),
    linear-gradient(to right, rgba(255,255,255,0.15), rgba(255,255,255,0));
  background-position:
    calc(100% - 1.4rem) center,
    calc(100% - 0.9rem) center,
    center;
  background-size:
    8px 8px,
    8px 8px,
    auto;
  background-repeat: no-repeat;
}

.font-select:hover,
.font-select:focus-visible {
  border-color: color-mix(in oklab, var(--rp-iris) 28%, transparent);
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--rp-iris) 12%, transparent);
  color: var(--rp-text);
}

/* Focus-visible accessibility ring across interactive elements */
:where(a, button, [role="button"], input, select, textarea, [tabindex]):focus-visible {
  outline: 2px solid color-mix(in oklab, var(--rp-iris) 70%, transparent);
  outline-offset: 2px;
  box-shadow: 0 0 0 6px color-mix(in oklab, var(--rp-iris) 18%, transparent);
}

/* Cards: subtle hover animation and glow */
.card {
  @apply rounded-2xl;
  background: color-mix(in oklab, var(--rp-surface) 80%, transparent);
  border: 1px solid color-mix(in oklab, var(--rp-iris) 14%, transparent);
  backdrop-filter: blur(var(--blur));
  box-shadow: var(--shadow-soft);
  transition: transform .2s var(--ease-smooth), background .2s var(--ease-smooth), border-color .2s var(--ease-smooth), box-shadow .2s var(--ease-smooth);
}
.card:hover, .card:focus-visible {
  transform: translateY(-2px) scale(1.01);
  border-color: color-mix(in oklab, var(--rp-iris) 26%, transparent);
  box-shadow: 0 10px 36px rgba(0,0,0,.4);
}

.stats-bar .glass,
[data-archive-shell] h2,
[data-archive-shell] h3 {
  text-wrap: balance;
  font-family: var(--typing-font);
}

[data-archive-shell] p {
  text-wrap: pretty;
}

/* Context-aware highlights using :has() (scoped for supporting browsers) */
@supports selector(:has(*)) {
  .glass:has(input:focus-visible),
  .glass:has(textarea:focus-visible),
  .card:has(:focus-visible) {
    border-color: color-mix(in oklab, var(--rp-iris) 28%, transparent);
    box-shadow: 0 0 0 6px color-mix(in oklab, var(--rp-iris) 12%, transparent), var(--shadow-soft);
  }
}

/* Scroll snap utilities (used by Archive overlay lists) */
.snap-y { scroll-snap-type: y proximity; }
.snap-x { scroll-snap-type: x proximity; }
.snap-mandatory { scroll-snap-type: y mandatory; }
.snap-item { scroll-snap-align: start; }

/* Container queries for responsive HUD layout */
.stats-cq-host { container: zen-shell / inline-size; }
.stats-cq { container-type: inline-size; }

@container zen-shell (max-width: 900px) {
  header.fixed {
    flex-wrap: wrap;
    gap: 1.25rem;
  }

  header.fixed > div:last-child {
    width: 100%;
    justify-content: space-between;
    gap: 1rem;
  }
}

@container (max-width: 720px) {
  .stats-bar {
    position: static;
    transform: none;
    margin: 1rem auto 0;
    left: auto;
    right: auto;
    bottom: auto;
  }

  .stats-bar .glass {
    justify-content: space-between;
    width: min(100% - 1.5rem, 28rem);
  }
}

@container (max-width: 560px) {
  .stats-bar {
    margin-bottom: 0.5rem;
  }
  .stats-bar .glass {
    padding: .5rem .75rem;
    gap: 1.25rem;
  }
}

@container (min-width: 1000px) {
  .stats-bar .glass { gap: 2rem; }
}

/* Page transitions - smoother and more subtle */
html.page-enter body {
  opacity: 0;
  transform: translateY(8px) scale(0.99);
}

html.page-enter body,
html.page-exit body {
  transition: 
    opacity 420ms cubic-bezier(0.4, 0, 0.2, 1),
    transform 420ms cubic-bezier(0.4, 0, 0.2, 1),
    filter 420ms cubic-bezier(0.4, 0, 0.2, 1);
}

html.page-enter.body-ready body {
  opacity: 1;
  transform: translateY(0) scale(1);
}

html.page-exit body {
  opacity: 0;
  transform: translateY(-8px) scale(1.01);
  filter: blur(2px);
}

/* Lightweight grain overlay */
.grain {
  background-image:
    radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
    radial-gradient(rgba(0,0,0,0.04) 1px, transparent 1px);
  background-size: 2px 2px, 3px 3px;
  background-position: 0 0, 1px 1px;
  opacity: .25;
  mix-blend-mode: soft-light;
}

/* Theme base layer */
.theme-layer {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--theme-gradient, linear-gradient(180deg, var(--rp-base), var(--rp-overlay)));
  filter: none;
}

.theme-layer > .forest-rays,
.theme-layer > .ocean-lights {
  position: absolute;
  inset: -14% -18% -10% -18%;
  pointer-events: none;
  display: none;
  z-index: 0;
}

/* Keyframes */
@keyframes forestBreath90 {
  0%,100% {
    background-position: 50% 52%, 16% -6%, 82% -10%, 50% 100%;
    filter: saturate(0.96);
  }
  50% {
    background-position: 52% 49%, 18% -4%, 80% -8%, 50% 102%;
    filter: saturate(1.04);
  }
}
@keyframes leafGlide90 {
  0% {
    background-position: 15% -15%, 42% -20%, 65% -12%, 85% -18%;
    opacity: 0;
  }
  10% {
    opacity: .05;
  }
  50% {
    background-position: 18% 45%, 45% 40%, 62% 48%, 82% 42%;
    opacity: .04;
  }
  90% {
    opacity: .02;
  }
  100% {
    background-position: 20% 110%, 48% 108%, 58% 112%, 78% 110%;
    opacity: 0;
  }
}
@keyframes oceanDrift90 {
  0%,100% {
    background-position: 50% 52%, 50% 50%, 50% 48%;
  }
  50% {
    background-position: 48% 50%, 52% 49%, 50% 51%;
  }
}
@keyframes oceanBubble30 {
  0% {
    background-position: 20% 110%, 60% 115%, 85% 112%;
    opacity: 0;
  }
  5% {
    opacity: .84;
  }
  50% {
    background-position: 22% 55%, 62% 58%, 83% 52%;
    opacity: .66;
  }
  95% {
    opacity: .38;
  }
  100% {
    background-position: 24% -5%, 64% -8%, 81% -10%;
    opacity: 0;
  }
}
@keyframes oceanBubbleSlow60 {
  0% {
    background-position: 12% 120%, 42% 118%, 78% 122%;
    opacity: 0;
  }
  10% {
    opacity: .36;
  }
  55% {
    background-position: 14% 62%, 44% 60%, 76% 64%;
    opacity: .42;
  }
  95% {
    opacity: .12;
  }
  100% {
    background-position: 16% -6%, 46% -4%, 74% -2%;
    opacity: 0;
  }
}
@keyframes oceanLightSweep30 {
  0% {
    transform: translateY(0%) scaleY(1);
    opacity: .18;
  }
  50% {
    transform: translateY(-2.5%) scaleY(1.05);
    opacity: .28;
  }
  100% {
    transform: translateY(0.5%) scaleY(1);
    opacity: .1;
  }
}
@keyframes oceanParticleDrift80 {
  0% {
    background-position:
      center top,
      18% 118%,
      74% 120%,
      46% 122%;
    transform: translate3d(0, 0, 0);
    opacity: .26;
  }
  50% {
    background-position:
      center top,
      22% 76%,
      70% 82%,
      44% 86%;
    transform: translate3d(1.2%, -2%, 0);
    opacity: .32;
  }
  100% {
    background-position:
      center top,
      26% 38%,
      66% 46%,
      42% 52%;
    transform: translate3d(-1.4%, -4%, 0);
    opacity: .22;
  }
}
@keyframes horizonShimmer15 {
  0%,100% {
    opacity: .35;
    transform: translateY(0);
  }
  50% {
    opacity: .45;
    transform: translateY(-0.5%);
  }
}
@keyframes forest-ray-veil {
  0% {
    transform: translate3d(-1%, -2%, 0) scale(1.02);
    filter: blur(0.2px) saturate(0.96);
  }
  48% {
    transform: translate3d(1.6%, 2.2%, 0) scale(1.05);
    filter: blur(0.4px) saturate(1.02);
  }
  100% {
    transform: translate3d(-1.4%, 1.4%, 0) scale(1.01);
    filter: blur(0.2px) saturate(0.98);
  }
}
@keyframes forest-ray-sweep {
  0% {
    transform: rotate(-0.6deg) translate3d(-1%, 0, 0);
    opacity: 0.16;
  }
  36% {
    transform: rotate(0.45deg) translate3d(1.5%, -1.2%, 0);
    opacity: 0.22;
  }
  68% {
    transform: rotate(-0.35deg) translate3d(1.2%, -0.6%, 0);
    opacity: 0.2;
  }
  100% {
    transform: rotate(-0.75deg) translate3d(-1.4%, 0.8%, 0);
    opacity: 0.15;
  }
}
@keyframes ocean-caustic-phase {
  0% {
    background-position: center 92%, 50% 104%;
    transform: translate3d(-1%, 0.8%, 0) scale(1.01);
    opacity: 0.24;
  }
  52% {
    background-position: center 96%, 52% 108%;
    transform: translate3d(1.4%, -1.6%, 0) scale(1.04);
    opacity: 0.3;
  }
  100% {
    background-position: center 90%, 48% 102%;
    transform: translate3d(-1.2%, 0.6%, 0) scale(1);
    opacity: 0.25;
  }
}
@keyframes ocean-highlight-rise {
  0% {
    background-position: 50% 112%, 50% 66%;
    opacity: 0.28;
  }
  50% {
    background-position: 50% 106%, 50% 60%;
    opacity: 0.34;
  }
  100% {
    background-position: 50% 114%, 50% 63%;
    opacity: 0.27;
  }
}
@keyframes ocean-horizon-drift {
  0% {
    transform: translate3d(-0.8%, 0, 0) skewX(-0.3deg);
  }
  42% {
    transform: translate3d(1.5%, -0.6%, 0) skewX(0.35deg);
  }
  78% {
    transform: translate3d(-0.6%, -0.3%, 0) skewX(-0.2deg);
  }
  100% {
    transform: translate3d(-1%, 0.2%, 0) skewX(0deg);
  }
}
/* Forest: True greens with Rosé Pine harmony and organic overlays */
html.theme-forest {
  --forest-0: #060d09;
  --forest-1: #0a140e;
  --forest-2: #0f1f16;
  --forest-3: #16301f;
  --forest-4: #1d3f28;
  --moss: #5ba876;
  --leaf: #8ec4a0;
  --emerald: #3cb888;
  --jade: #66c99a;
  --pine-mix: color-mix(in oklab, var(--rp-pine) 35%, #0f1f16 65%);
  --fern-glow: color-mix(in oklab, var(--leaf) 22%, transparent);
  --canopy-light: color-mix(in oklab, var(--moss) 20%, transparent);
  --canopy-wash: rgba(20, 38, 28, 0.42);
  --forest-foam: color-mix(in oklab, var(--rp-foam) 18%, transparent);
  --forest-leaf-highlight: color-mix(in oklab, var(--leaf) 32%, rgba(12, 28, 20, 0.45));
  --forest-ray-core: color-mix(in oklab, var(--emerald) 22%, rgba(255, 255, 255, 0.06));
  --forest-ray-soft: color-mix(in oklab, var(--moss) 14%, transparent);
  --forest-ray-falloff: color-mix(in oklab, var(--jade) 18%, transparent);
  --forest-mist-alpha: 0.24;
  --forest-depth: color-mix(in oklab, var(--forest-0) 92%, var(--moss) 8%);
  --forest-mid: color-mix(in oklab, var(--forest-2) 88%, var(--emerald) 12%);
  --forest-highlight: color-mix(in oklab, var(--forest-3) 82%, var(--jade) 18%);
}
html.theme-forest .theme-layer {
  background:
    radial-gradient(ellipse 120% 80% at 50% 0%, color-mix(in oklab, var(--forest-2) 28%, var(--forest-0) 72%) 0%, var(--forest-0) 70%),
    radial-gradient(ellipse 110% 60% at 50% 100%, color-mix(in oklab, var(--forest-1) 18%, var(--forest-0) 82%) 0%, var(--forest-0) 55%),
    linear-gradient(180deg, 
      color-mix(in oklab, var(--forest-1) 85%, var(--moss) 15%) 0%, 
      color-mix(in oklab, var(--forest-0) 95%, var(--emerald) 5%) 35%,
      var(--forest-0) 100%
    );
}
/* Organic canopy glow overlay */
html.theme-forest .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 75% 50% at 50% 40%, color-mix(in oklab,var(--fern-glow) 38%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 60% 42% at 20% 15%, color-mix(in oklab,var(--canopy-light) 40%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 58% 38% at 80% 18%, color-mix(in oklab,var(--emerald) 12%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  background-repeat: no-repeat;
  mix-blend-mode: screen;
  opacity: .32;
  animation: forest-midglow-drift calc(105s * 1.05) cubic-bezier(0.32, 0.68, 0.3, 0.96) infinite;
}
/* Atmospheric depth and breathing gradient */
html.theme-forest[data-motion="on"] .theme-layer::after {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 115% 85% at 50% 50%, color-mix(in oklab,var(--fern-glow) 35%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 90% 65% at 50% 20%, color-mix(in oklab,var(--leaf) 8%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  mix-blend-mode: screen;
  opacity: 0.16;
  animation:
    forest-breathe calc(104s * 1.02) cubic-bezier(0.28, 0.7, 0.3, 0.96) infinite alternate,
    forest-pollen-drift calc(70s * 0.94) cubic-bezier(0.28, 0.64, 0.3, 0.96) infinite;
}
@keyframes forest-breathe {
  0%,100% { filter: brightness(1) saturate(1); }
  50% { filter: brightness(1.06) saturate(1.02); }
}
@keyframes forest-midglow-drift {
  0% { transform: translate3d(-1.2%, 1.5%, 0); }
  40% { transform: translate3d(1.4%, -1.2%, 0); }
  70% { transform: translate3d(-0.8%, -2.4%, 0); }
  100% { transform: translate3d(1%, -0.8%, 0); }
}
@keyframes forest-mist-pulse {
  0%,100% { filter: blur(0.6px); }
  50% { filter: blur(1.4px); }
}
@keyframes forest-pollen-drift {
  0% {
    transform: translate3d(-1%, 2%, 0);
    opacity: .18;
  }
  40% {
    transform: translate3d(1.5%, -1.5%, 0);
    opacity: .24;
  }
  70% {
    transform: translate3d(-0.5%, -3%, 0);
    opacity: .2;
  }
  100% {
    transform: translate3d(1%, -1%, 0);
    opacity: .18;
  }
}
/* Enhanced forest light rays */
html.theme-forest .forest-rays {
  display: block;
  position: absolute;
  inset: -18% -24% -14%;
  opacity: 0.16;
  mix-blend-mode: screen;
  transform-origin: 50% 10%;
}

html.theme-forest .forest-rays::before,
html.theme-forest .forest-rays::after {
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  mask-image: radial-gradient(125% 125% at 50% 18%, rgba(0,0,0,1) 0%, rgba(0,0,0,0.75) 60%, rgba(0,0,0,0) 92%);
}

html.theme-forest .forest-rays::before {
  background-image:
    radial-gradient(120% 90% at 50% 2%, color-mix(in oklab,var(--forest-ray-core) 58%, transparent) 0%, transparent 78%),
    radial-gradient(145% 95% at 48% 28%, color-mix(in oklab,var(--forest-ray-soft) 52%, transparent) 0%, transparent 85%),
    radial-gradient(100% 70% at 50% 8%, color-mix(in oklab,var(--jade) 24%, transparent) 0%, transparent 88%);
  opacity: 0.22;
  animation:
    forest-ray-veil calc(150s * 1.04) cubic-bezier(0.28, 0.62, 0.3, 0.94) infinite;
}

html.theme-forest .forest-rays::after {
  background-image:
    conic-gradient(from 115deg at 50% -12%, transparent 0deg 20deg, color-mix(in oklab,var(--forest-ray-core) 85%, transparent) 34deg 68deg, transparent 92deg 360deg),
    linear-gradient(102deg, transparent 0%, color-mix(in oklab,var(--forest-ray-falloff) 68%, transparent) 26%, transparent 58%),
    linear-gradient(168deg, transparent 0%, color-mix(in oklab,var(--forest-leaf-highlight) 58%, transparent) 38%, transparent 85%),
    radial-gradient(ellipse 80% 60% at 50% 15%, color-mix(in oklab,var(--emerald) 18%, transparent) 0%, transparent 100%);
  opacity: 0.18;
  mix-blend-mode: screen;
  animation:
    forest-ray-sweep calc(146s * 0.96) cubic-bezier(0.26, 0.68, 0.3, 0.96) infinite;
}

html.theme-forest[data-motion="off"] .forest-rays::before,
html.theme-forest[data-motion="off"] .forest-rays::after {
  animation: none;
  transform: none;
}

html.theme-forest .grain { background: none !important; opacity: 0 !important; }

/* Ocean: Deep blues with seafoam accents and wave shimmer */
html.theme-ocean {
  --ocean-0: #050f18;
  --ocean-1: #081a28;
  --ocean-2: #0c2838;
  --ocean-3: #103a4f;
  --ocean-4: #164d66;
  --seafoam: #9ccfd8;
  --aqua: #7eb8c8;
  --cyan: #5da9bd;
  --teal: #4a95a8;
  --deep: #061220;
  --ocean-depth: color-mix(in oklab, var(--ocean-0) 92%, var(--seafoam) 8%);
  --ocean-mid: color-mix(in oklab, var(--ocean-2) 88%, var(--cyan) 12%);
  --ocean-surface: color-mix(in oklab, var(--ocean-3) 82%, var(--aqua) 18%);
  --wave-glow: color-mix(in oklab, var(--seafoam) 28%, transparent);
  --deep-glow: color-mix(in oklab, var(--cyan) 22%, transparent);
  --surface-shimmer: color-mix(in oklab, var(--aqua) 18%, transparent);
  --plankton-foam: color-mix(in oklab, var(--seafoam) 35%, transparent);
  --plankton-iris: color-mix(in oklab, var(--rp-iris) 30%, transparent);
  --caustic-core: color-mix(in oklab, var(--cyan) 20%, rgba(255, 255, 255, 0.05));
  --caustic-soft: color-mix(in oklab, var(--seafoam) 15%, transparent);
  --ocean-mist-alpha: 0.22;
}

@supports not (color: color-mix(in oklab, white 50%, black 50%)) {
  html.theme-forest {
    --pine-mix: #1d3d49;
    --fern-glow: rgba(142, 196, 160, 0.22);
    --canopy-light: rgba(91, 168, 118, 0.20);
    --forest-foam: rgba(156, 207, 216, 0.18);
    --forest-leaf-highlight: rgba(142, 196, 160, 0.32);
    --forest-ray-core: rgba(60, 184, 136, 0.22);
    --forest-ray-soft: rgba(91, 168, 118, 0.14);
    --forest-ray-falloff: rgba(102, 201, 154, 0.18);
    --forest-depth: rgba(6, 13, 9, 1);
    --forest-mid: rgba(15, 31, 22, 1);
    --forest-highlight: rgba(22, 48, 31, 1);
  }

  html.theme-ocean {
    --ocean-depth: rgba(5, 15, 24, 1);
    --ocean-mid: rgba(12, 40, 56, 1);
    --ocean-surface: rgba(16, 58, 79, 1);
    --wave-glow: rgba(156, 207, 216, 0.28);
    --deep-glow: rgba(93, 169, 189, 0.22);
    --surface-shimmer: rgba(126, 184, 200, 0.18);
    --plankton-foam: rgba(156, 207, 216, 0.35);
    --plankton-iris: rgba(196, 167, 231, 0.30);
    --caustic-core: rgba(93, 169, 189, 0.20);
    --caustic-soft: rgba(156, 207, 216, 0.15);
  }
}
html.theme-ocean .theme-layer {
  background:
    radial-gradient(ellipse 125% 85% at 50% 0%, color-mix(in oklab, var(--ocean-2) 30%, var(--ocean-0) 70%) 0%, var(--ocean-0) 70%),
    radial-gradient(ellipse 115% 65% at 50% 100%, color-mix(in oklab, var(--ocean-1) 20%, var(--ocean-0) 80%) 0%, var(--ocean-0) 60%),
    linear-gradient(180deg, 
      color-mix(in oklab, var(--ocean-1) 82%, var(--seafoam) 18%) 0%, 
      color-mix(in oklab, var(--ocean-0) 94%, var(--cyan) 6%) 38%,
      var(--ocean-0) 100%
    );
}
/* Wave shimmer atmospheric layers */
html.theme-ocean .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 78% 48% at 50% 35%, color-mix(in oklab,var(--wave-glow) 42%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 62% 40% at 22% 18%, color-mix(in oklab,var(--deep-glow) 38%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 58% 38% at 78% 20%, color-mix(in oklab,var(--surface-shimmer) 35%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  background-repeat: no-repeat;
  mix-blend-mode: screen;
  opacity: .36;
  animation: ocean-surface-drift calc(95s * 1.04) cubic-bezier(0.32, 0.68, 0.3, 0.96) infinite;
}
html.theme-ocean[data-motion="on"] .theme-layer::after {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 120% 88% at 50% 48%, color-mix(in oklab,var(--plankton-foam) 40%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 95% 68% at 50% 18%, color-mix(in oklab,var(--plankton-iris) 12%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  mix-blend-mode: screen;
  opacity: var(--ocean-mist-alpha);
  animation:
    ocean-breathe calc(98s * 1.02) cubic-bezier(0.28, 0.7, 0.3, 0.96) infinite alternate,
    ocean-current-drift calc(72s * 0.96) cubic-bezier(0.28, 0.64, 0.3, 0.96) infinite;
}
@keyframes ocean-breathe {
  0%,100% { filter: brightness(1) saturate(1); }
  50% { filter: brightness(1.05) saturate(1.02); }
}
@keyframes ocean-surface-drift {
  0% { transform: translate3d(-1%, 1.2%, 0); }
  38% { transform: translate3d(1.2%, -1%, 0); }
  68% { transform: translate3d(-0.7%, -2%, 0); }
  100% { transform: translate3d(0.8%, -0.6%, 0); }
}
@keyframes ocean-current-drift {
  0% {
    transform: translate3d(-0.8%, 1.8%, 0);
    opacity: .18;
  }
  38% {
    transform: translate3d(1.3%, -1.2%, 0);
    opacity: .24;
  }
  68% {
    transform: translate3d(-0.4%, -2.6%, 0);
    opacity: .2;
  }
  100% {
    transform: translate3d(0.9%, -0.8%, 0);
    opacity: .18;
  }
}
html.theme-ocean .grain { background: none !important; opacity: 0 !important; }

/* Cosmic: Dark violet/black base with Rosé Pine accents */
html.theme-cosmic {
  --cosmic-0: #030008;
  --cosmic-1: #08050f;
  --cosmic-2: #0f0a1a;
  --cosmic-3: #1a1228;
  --cosmic-4: #261b38;
  --nebula: #c4a7e7;
  --stardust: #a88bc7;
  --void: #8a75a8;
  --cosmic-depth: color-mix(in oklab, var(--cosmic-0) 94%, var(--rp-iris) 6%);
  --cosmic-mid: color-mix(in oklab, var(--cosmic-2) 88%, var(--nebula) 12%);
  --cosmic-glow: color-mix(in oklab, var(--nebula) 25%, transparent);
  --star-core: color-mix(in oklab, var(--nebula) 32%, rgba(255, 255, 255, 0.08));
  --star-halo: color-mix(in oklab, var(--stardust) 18%, transparent);
  --nebula-shimmer: color-mix(in oklab, var(--void) 15%, transparent);
  --cosmic-mist-alpha: 0.2;
}
html.theme-cosmic .theme-layer {
  background:
    radial-gradient(ellipse 125% 80% at 50% 0%, color-mix(in oklab, var(--cosmic-2) 32%, var(--cosmic-0) 68%) 0%, var(--cosmic-0) 68%),
    radial-gradient(ellipse 115% 68% at 50% 100%, color-mix(in oklab, var(--cosmic-1) 22%, var(--cosmic-0) 78%) 0%, var(--cosmic-0) 62%),
    linear-gradient(180deg, 
      color-mix(in oklab, var(--cosmic-1) 80%, var(--rp-iris) 20%) 0%, 
      color-mix(in oklab, var(--cosmic-0) 96%, var(--nebula) 4%) 36%,
      var(--cosmic-0) 100%
    );
}
/* Nebula glow atmospheric layers */
html.theme-cosmic .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 72% 50% at 50% 38%, color-mix(in oklab,var(--cosmic-glow) 40%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 58% 42% at 24% 22%, color-mix(in oklab,var(--star-halo) 36%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 60% 40% at 76% 24%, color-mix(in oklab,var(--nebula-shimmer) 32%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  background-repeat: no-repeat;
  mix-blend-mode: screen;
  opacity: .38;
  animation: cosmic-nebula-drift calc(110s * 1.04) cubic-bezier(0.32, 0.68, 0.3, 0.96) infinite;
}
html.theme-cosmic[data-motion="on"] .theme-layer::after {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 118% 85% at 50% 50%, color-mix(in oklab,var(--cosmic-glow) 38%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 92% 66% at 50% 22%, color-mix(in oklab,var(--nebula-shimmer) 12%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  mix-blend-mode: screen;
  opacity: var(--cosmic-mist-alpha);
  animation:
    cosmic-breathe calc(102s * 1.02) cubic-bezier(0.28, 0.7, 0.3, 0.96) infinite alternate,
    cosmic-void-drift calc(78s * 0.98) cubic-bezier(0.28, 0.64, 0.3, 0.96) infinite;
}
@keyframes cosmic-breathe {
  0%,100% { filter: brightness(1) saturate(1); }
  50% { filter: brightness(1.06) saturate(1.03); }
}
@keyframes cosmic-nebula-drift {
  0% { transform: translate3d(-1.1%, 1.4%, 0); }
  36% { transform: translate3d(1.3%, -1.1%, 0); }
  66% { transform: translate3d(-0.8%, -2.2%, 0); }
  100% { transform: translate3d(0.9%, -0.7%, 0); }
}
@keyframes cosmic-void-drift {
  0% {
    transform: translate3d(-0.9%, 1.6%, 0);
    opacity: .16;
  }
  36% {
    transform: translate3d(1.2%, -1.3%, 0);
    opacity: .22;
  }
  66% {
    transform: translate3d(-0.5%, -2.4%, 0);
    opacity: .18;
  }
  100% {
    transform: translate3d(0.8%, -0.9%, 0);
    opacity: .16;
  }
}
html.theme-cosmic .grain {
  background-image:
    radial-gradient(rgba(255,255,255,0.025) 1px, transparent 1px),
    radial-gradient(rgba(0,0,0,0.05) 1px, transparent 1px),
    linear-gradient(180deg, rgba(18,8,37,0.3) 0%, rgba(5,0,10,0) 100%);
  background-size: 3px 3px, 4px 4px, 100% 100%;
  background-position: 0 0, 1px 1px, 0 0;
  opacity: .18;
  mix-blend-mode: soft-light;
}

/* Void: Deep Rosé Pine void with soft aurora pulses */
html.theme-void {
  --void-0: #0a0812;
  --void-1: #12101a;
  --void-2: #191724;
  --void-3: #21202e;
  --void-depth: color-mix(in oklab, var(--rp-base) 88%, #000 12%);
  --void-mid: color-mix(in oklab, var(--rp-overlay) 90%, var(--rp-iris) 10%);
  --aurora-iris: color-mix(in oklab, var(--rp-iris) 22%, transparent);
  --aurora-foam: color-mix(in oklab, var(--rp-foam) 18%, transparent);
  --aurora-gold: color-mix(in oklab, var(--rp-gold) 12%, transparent);
  --void-shimmer: color-mix(in oklab, var(--rp-iris) 15%, transparent);
  --void-mist-alpha: 0.18;
}
html.theme-void .theme-layer {
  background:
    radial-gradient(ellipse 120% 78% at 50% 0%, color-mix(in oklab, var(--void-2) 26%, var(--void-0) 74%) 0%, var(--void-0) 72%),
    radial-gradient(ellipse 110% 62% at 50% 100%, color-mix(in oklab, var(--void-1) 16%, var(--void-0) 84%) 0%, var(--void-0) 58%),
    linear-gradient(180deg, 
      color-mix(in oklab, var(--rp-overlay) 78%, var(--rp-iris) 22%) 0%, 
      color-mix(in oklab, var(--rp-base) 94%, #000 6%) 40%,
      var(--void-0) 100%
    );
}
/* Aurora shimmer atmospheric layers */
html.theme-void .theme-layer::before {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 68% 42% at 50% 50%, color-mix(in oklab,var(--aurora-iris) 45%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 54% 36% at 30% 32%, color-mix(in oklab,var(--aurora-foam) 38%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 50% 32% at 70% 36%, color-mix(in oklab,var(--aurora-gold) 32%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  background-repeat: no-repeat;
  mix-blend-mode: screen;
  opacity: .40;
  animation: void-aurora-drift calc(88s * 1.05) cubic-bezier(0.32, 0.68, 0.3, 0.96) infinite;
}
html.theme-void[data-motion="on"] .theme-layer::after {
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image:
    radial-gradient(ellipse 112% 80% at 50% 52%, color-mix(in oklab,var(--aurora-iris) 42%, transparent) 0%, transparent 100%),
    radial-gradient(ellipse 88% 62% at 50% 26%, color-mix(in oklab,var(--void-shimmer) 14%, transparent) 0%, transparent 100%);
  background-size: 100% 100%;
  background-position: center;
  mix-blend-mode: screen;
  opacity: var(--void-mist-alpha);
  animation:
    void-breathe calc(94s * 1.02) cubic-bezier(0.28, 0.7, 0.3, 0.96) infinite alternate,
    void-pulse-drift calc(68s * 0.96) cubic-bezier(0.28, 0.64, 0.3, 0.96) infinite;
}
@keyframes void-breathe {
  0%,100% { filter: brightness(1) saturate(1); }
  50% { filter: brightness(1.04) saturate(1.02); }
}
@keyframes void-aurora-drift {
  0% { transform: translate3d(-0.9%, 1%, 0); }
  34% { transform: translate3d(1.1%, -0.9%, 0); }
  64% { transform: translate3d(-0.6%, -1.8%, 0); }
  100% { transform: translate3d(0.7%, -0.5%, 0); }
}
@keyframes void-pulse-drift {
  0% {
    transform: translate3d(-0.7%, 1.4%, 0);
    opacity: .14;
  }
  34% {
    transform: translate3d(1%, -1.1%, 0);
    opacity: .20;
  }
  64% {
    transform: translate3d(-0.4%, -2%, 0);
    opacity: .16;
  }
  100% {
    transform: translate3d(0.6%, -0.7%, 0);
    opacity: .14;
  }
}
html.theme-void .grain {
  opacity: .18;
  mix-blend-mode: soft-light;
}
html.high-contrast .grain {
  opacity: .3;
}
html.high-contrast.theme-forest .theme-layer::after {
  opacity: .66;
}
html.high-contrast.theme-ocean .theme-layer::after {
  opacity: .2;
}
html.high-contrast.theme-cosmic .theme-layer::before {
  opacity: .75;
}
html.high-contrast.theme-cosmic .theme-layer::after {
  opacity: .2;
}
html.high-contrast.theme-void .theme-layer::after {
  opacity: .78;
}

/* Zen typing animations */
@keyframes zen-input-breathe {
  0%, 100% {
    box-shadow: 
      0 0 0 0 rgba(196, 167, 231, 0),
      0 4px 12px rgba(0, 0, 0, 0.3),
      inset 0 0 0 1px rgba(196, 167, 231, 0.15);
  }
  50% {
    box-shadow: 
      0 0 0 4px rgba(196, 167, 231, 0.08),
      0 6px 16px rgba(0, 0, 0, 0.35),
      inset 0 0 0 1px rgba(196, 167, 231, 0.25);
  }
}

@keyframes zen-input-focus {
  from {
    box-shadow: 
      0 0 0 0 rgba(196, 167, 231, 0),
      0 4px 12px rgba(0, 0, 0, 0.3),
      inset 0 0 0 1px rgba(196, 167, 231, 0.15);
  }
  to {
    box-shadow: 
      0 0 0 6px rgba(196, 167, 231, 0.12),
      0 6px 20px rgba(0, 0, 0, 0.4),
      inset 0 0 0 1px rgba(196, 167, 231, 0.3);
  }
}

@keyframes zen-ripple {
  0% {
    box-shadow:
      0 0 0 0 rgba(156, 207, 216, 0.4),
      0 0 0 0 rgba(196, 167, 231, 0.3),
      0 4px 12px rgba(0, 0, 0, 0.3),
      inset 0 0 0 1px rgba(196, 167, 231, 0.2);
  }
  50% {
    box-shadow:
      0 0 0 8px rgba(156, 207, 216, 0.1),
      0 0 0 16px rgba(196, 167, 231, 0.05),
      0 6px 16px rgba(0, 0, 0, 0.35),
      inset 0 0 0 1px rgba(196, 167, 231, 0.25);
  }
  100% {
    box-shadow:
      0 0 0 12px rgba(156, 207, 216, 0),
      0 0 0 24px rgba(196, 167, 231, 0),
      0 4px 12px rgba(0, 0, 0, 0.3),
      inset 0 0 0 1px rgba(196, 167, 231, 0.2);
  }
}

@keyframes zen-caret-pulse {
  0%, 100% {
    opacity: 1;
    transform: scaleY(1);
  }
  50% {
    opacity: 0.7;
    transform: scaleY(0.95);
  }
}

@keyframes zen-char-appear {
  from {
    opacity: 0;
    transform: translateY(2px) scale(0.98);
    filter: blur(1px);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
    filter: blur(0);
  }
}

@keyframes zen-glow-pulse {
  0%, 100% {
    text-shadow: 0 0 8px rgba(196, 167, 231, 0.3);
  }
  50% {
    text-shadow: 0 0 12px rgba(196, 167, 231, 0.5);
  }
}

@keyframes blink {
  50% {
    opacity: 0;
  }
}

@keyframes vt-fade-out {
  from { 
    opacity: 1;
    transform: scale(1);
    filter: blur(0);
  }
  to { 
    opacity: 0;
    transform: scale(1.02);
    filter: blur(3px);
  }
}

@keyframes vt-fade-in {
  from { 
    opacity: 0;
    transform: scale(0.98);
    filter: blur(3px);
  }
  to { 
    opacity: 1;
    transform: scale(1);
    filter: blur(0);
  }
}

::root::view-transition-old(root),
::root::view-transition-new(root) {
  animation-duration: 380ms;
  animation-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

::root::view-transition-old(root) {
  animation-name: vt-fade-out;
}

::root::view-transition-new(root) {
  animation-name: vt-fade-in;
}

::root[data-transition-theme="theme-void"]::view-transition-new(root) {
  animation-name: vt-fade-in;
  animation-duration: 420ms;
}

::root[data-transition-theme="theme-forest"]::view-transition-new(root),
::root[data-transition-theme="theme-ocean"]::view-transition-new(root),
::root[data-transition-theme="theme-cosmic"]::view-transition-new(root) {
  animation-duration: 420ms;
}

@media (prefers-reduced-motion: reduce) {
  body {
    transition: none !important;
  }

  html.theme-forest .theme-layer,
  html.theme-forest .theme-layer::before,
  html.theme-forest .theme-layer::after,
  html.theme-ocean .theme-layer,
  html.theme-ocean .theme-layer::before,
  html.theme-ocean .theme-layer::after,
  html.theme-cosmic .theme-layer,
  html.theme-cosmic .theme-layer::before,
  html.theme-cosmic .theme-layer::after,
  html.theme-void .theme-layer,
  html.theme-void .theme-layer::after,
  .grain {
    animation: none !important;
    transform: none !important;
  }

  html.theme-forest .theme-layer,
  html.theme-cosmic .theme-layer,
  html.theme-void .theme-layer {
    filter: none !important;
  }

  html.theme-ocean .theme-layer::after {
    opacity: .08 !important;
  }
}

@media (prefers-contrast: more) {
  :root {
    --shadow-soft: 0 0 0 1px rgba(255,255,255,0.35);
  }

  .glass,
  .card {
    border-color: color-mix(in oklab, var(--rp-iris) 35%, transparent);
    background: color-mix(in oklab, var(--rp-surface) 92%, transparent);
  }

  :where(button, a, input, textarea, select) {
    border-color: color-mix(in oklab, var(--rp-foam) 40%, transparent) !important;
  }
}

@supports (scrollbar-color: auto) {
  body {
    scrollbar-color: rgba(144,140,170,0.65) transparent;
  }
}

body::-webkit-scrollbar,
.stats-bar::-webkit-scrollbar {
  height: 10px;
  width: 10px;
}

body::-webkit-scrollbar-thumb,
.stats-bar::-webkit-scrollbar-thumb {
  background: rgba(144,140,170,0.4);
  border-radius: 999px;
}

/* Glass theme background - shows current theme gradient */
.glass-theme {
  background: var(--theme-gradient, linear-gradient(180deg, var(--rp-base) 0%, var(--rp-overlay) 100%));
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
}
